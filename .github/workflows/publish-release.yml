name: Publish Release (Manual Trigger)

on:
  workflow_dispatch:

jobs:
  release:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.11'

      - name: Install deps
        run: pip install -r scripts/requirements.txt

      # Generar embeddings locales si no existen
      - name: Compute embeddings (Ollama)
        run: echo "Skipping embedding generation in CI for now."
        # run: |
        #   ollama pull embeddinggemma:300m
        #   python scripts/embeddings/generate_embeddings.py

      # Crear GitHub Release
      - name: Create Release
        uses: ncipollo/release-action@v1
        with:
          artifacts: "README.md" # Placeholder artifact
          body: |
            # VermiKhipu RAG Dataset Release ${{ github.ref_name }}

            This is a placeholder release. The workflow needs to be updated with the correct artifacts and embedding generation steps.
          draft: true # Draft release until workflow is fixed
          token: ${{ secrets.GITHUB_TOKEN }}
